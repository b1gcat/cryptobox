package main

import (
	"encoding/hex"
	"fmt"
	"testing"

	"github.com/emmansun/gmsm/pkcs7"
)

func Test_parseP7b(t *testing.T) {
	p2bBytes, _ := hex.DecodeString(p7b)
	p7, err := pkcs7.Parse(p2bBytes)
	if err != nil {
		t.Error(err.Error())
		return
	}
	fmt.Println(p7.Certificates)
}

var (
	p7b = "3082047d06092a864886f70d010702a082046e3082046a0201013100300b06092a864886f70d010701a0820452308202973082023ca003020102021075dfc8554a8c03ab35cf59e8b8613b9e300c06082a811ccf550183750500302e310b300906035504061302434e310e300c060355040a0c054e52434143310f300d06035504030c06524f4f544341301e170d3133303131363131303733315a170d3333303131313131303733315a3044310b300906035504061302434e310d300b060355040a0c04424a4341310d300b060355040b0c04424a43413117301506035504030c0e4265696a696e6720534d322043413059301306072a8648ce3d020106082a811ccf5501822d034200048a8aaa470d2a9a33d8505fba4968162352730c73c63b48938d26b99b432e47f401f37c8b0649dc719dd3d6ac1d82fdbb7b7aaa28c740dd4de2a59933eaac5593a38201223082011e301f0603551d230418301680144c32b197d9331bc4a605c1c6e58b625bf0977658300f0603551d130101ff040530030101ff3081ba0603551d1f0481b23081af3041a03fa03da43b3039310b300906035504061302434e310e300c060355040a0c054e52434143310c300a060355040b0c0341524c310c300a06035504030c0361726c302aa028a0268624687474703a2f2f7777772e726f6f7463612e676f762e636e2f61726c2f61726c2e63726c303ea03ca03a86386c6461703a2f2f6c6461702e726f6f7463612e676f762e636e3a3338392f434e3d61726c2c4f553d41524c2c4f3d4e524341432c433d434e300e0603551d0f0101ff040403020106301d0603551d0e041604141fe6cfd48fc5222a974a298a15e716c99234c4b6300c06082a811ccf55018375050003470030440220588ca07d4147b2370e694f939ba1ba2fd6d9c5fa88f01d9d72382d23d483d4fd022074e970e9fb0b0f49c30163346e639c410bb2220be9e3f9e84c0e690b0f89972a308201b330820157a003020102020869e2fec0170ac67b300c06082a811ccf550183750500302e310b300906035504061302434e310e300c060355040a0c054e52434143310f300d06035504030c06524f4f544341301e170d3132303731343033313135395a170d3432303730373033313135395a302e310b300906035504061302434e310e300c060355040a0c054e52434143310f300d06035504030c06524f4f5443413059301306072a8648ce3d020106082a811ccf5501822d0342000430f09c6baa6681c721b137f652705e2fdaeda789f0fa2b64d4aceb99b9eaa34e655309309562bee0e22bb45740aa745357b43dbf586d92fe364ec22eb73775dba35d305b301f0603551d230418301680144c32b197d9331bc4a605c1c6e58b625bf0977658300c0603551d13040530030101ff300b0603551d0f040403020106301d0603551d0e041604144c32b197d9331bc4a605c1c6e58b625bf0977658300c06082a811ccf550183750500034800304502201b56d22de397a77a01f07edbe775be08a38f9763e49e6584abf94c86d9f6e479022100da1c3816c5616d9c2ac18c7d7afd6dc4ce7eff53f563a39c48a43a22561b0bc23100"
)
